# 朴素贝叶斯

> [非常详细的贝叶斯讲解](https://www.bilibili.com/video/BV1rq4y1m72f?p=1)

贝叶斯要解决的问题: 如何计算逆向概率

**正向概率**:已知袋子里有 M 个黑球, N 个白球,摸一个球摸出黑球的概率是多大?

**逆向概率**:一个未知的袋子里有一些黑球和白球,随机摸出一个或者好几个球,观察摸出的球可以对袋子里的黑球白球的比例做出什么样的推测?

> 举一个更形象的例子:
>
> 已知学校中的60%的人是男生,40%的人是女生,其中男生总是穿着长裤,女生则一半穿长裤,一半穿裙子

**正向概率**:随机选择一个男生或者女生,他/她穿长裤/裙子的概率是多少?

**逆向概率**:迎面走来一个穿着长裤的人,不能确定ta的性别,你能推断出ta是男生/女生的概率是多少?

条件概率的公式为 `P(X|Y)`,表示在已知 Y 情况下 X 发生的概率

所以对于正向概率,即我们已知男生女生,只需要根据题目中的概率直接就可以计算穿长裤和穿裙子的概率:

- P(穿长裤|男生) = 1
- P(穿裙子|男生) = 0
- P(穿长裤|女生) = 0.5
- P(穿裙子|女生) = 0.5

对于逆向概率,我们想求的是 `P(男生|穿长裤)` 和 `P(女生|穿长裤)`,这并不好直接计算

贝叶斯公式有一个推导式: `P(X|Y) = P(XY)/P(Y)`,所以这个问题可以转化为 `P(男生并且穿长裤)/P(穿长裤)` 和 `P(女生并且穿长裤)/P(穿长裤)`

这时分子分母都是可以计算的式子. 假设总人数 N ,穿长裤的人数为 `N*P(男)*1+N*P(女生)*0.5`,男生并且穿长裤的人数为 `N*P(男)*1`,女生并且穿长裤的人数为`N*P(女)*0.5`,上下相除 N 被约掉

我们可以将分子的 `P(XY)`分解, 等价于 `P(Y|X)*P(X)`,具体来说就是`P(男生并且穿长裤) = P(穿长裤|男生)*P(男生)`

所以我们在求逆向概率的时候得到了一个神奇的变换:

<img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20220420151446.png" height ="100">

贝叶斯公式就是在计算逆向概率的时候我们遇到一个不好直接求的条件概率,但是如果我们便于计算其反过来的条件概率,变换之后就很容易计算了

计算中我们注意到一个问题,就是这个情况下只有男生女生两类,也就是说穿长裤的不是男生就是女生,所以`P(穿长裤) = P(穿长裤|男生)*P(男生) + P(穿长裤|女生)*P(女生)`,分解一个大的概率`P(X)`,它可以由几种情况组成,我们可以写成公式

<img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20220420151624.png" height="100">

## dataset

[download](https://plg.uwaterloo.ca/~gvcormac/treccorpus06/)